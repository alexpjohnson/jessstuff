<md-dialog aria-label="tag types"  style="width:800px" ng-cloak>
  <form>
    <md-toolbar>
      <div class="md-toolbar-tools">
        <h2>tag types</h2>
        <span flex></span>
        <md-button class="md-icon-button" ng-click="close()">
          <md-icon class="material-icons" aria-label="Close dialog">close</md-icon>
        </md-button>
      </div>
    </md-toolbar>
    <md-dialog-content>
        <md-tabs 
            md-dynamic-height 
            md-border-bottom
            md-selected="selectedIndex"
            md-on-select="clearEditing()">
            <md-tab label="tags">
                
                <md-content>
                    
                <section ng-repeat="tag_type_group in tag_type_groups">
                  <md-subheader 
                    layout="row"
                    layout-align="end center"
                    ng-if="tag_type_group.name"
                    style="background-color:{{tag_type_group.color}};
                            color:white">
                      <strong>{{tag_type_group.name}}</strong>
                      <span flex></span>
                        
                            <md-button 
                                class="md-icon-button"
                                ng-click="editTagType(tag_type_group, 2)">
                                <md-icon class="material-icons">edit</md-icon>
                            </md-button>
                            <md-button 
                                class="md-icon-button"
                                ng-click="deleteTagGroup(tag_type_group)">
                                <md-icon class="material-icons">delete</md-icon>
                            </md-button>
                  </md-subheader>
                  <md-list layout-padding>
                    <md-list-item ng-repeat="tag_type in tag_type_group.tag_types | filter:$ctrl.query">
                        <div>
                            <div 
                              style="color: {{tag_type.color}}">
                                {{tag_type.name}}
                            </div>
                            
                        </div>
                        <span flex></span>
                        <div>
                        
                            <md-button 
                                class="md-accent md-icon-button"
                                ng-click="editTagType(tag_type, 1)">
                                <md-icon class="material-icons">edit</md-icon>
                            </md-button>
                            <md-button 
                                class="md-accent md-icon-button"
                                ng-click="deleteTagType(tag_type)">
                                <md-icon class="material-icons">delete</md-icon>
                            </md-button>
                        </div>
                    </md-list-item>
                  </md-list>
                </section>
                </md-content>
            </md-tab>
            <md-tab
                md-on-select="initNew(true)"
                md-on-deselect="clearEditing()">
                <md-label>
                    + tag type
                </md-label>
                    <md-tab-body>
                        <md-content class="md-padding">
                        <md-input-container 
                          style="width:80%">
                            <label>tag type name</label>
                            <input
                                required
                                ng-model="editingCopy.name"
                                aria-label="name"/>
                        </md-input-container>
                        <md-input-container
                            style="width:80%">
                            <label>tag type group</label>
                            <md-select 
                                ng-model="editingCopy.tag_type_group_id"
                                aria-label="tag type groups"
                                md-on-close="changeTagGroup(editingCopy)">
                                  <md-option value="">no group</md-option>
                                  <md-option 
                                    ng-repeat="group in tagGroups" 
                                    value="{{group.id}}">
                                        {{group.name}}
                                  </md-option>
                            </md-select>
                        </md-input-container>
                        <md-input-container>
                            <color-picker
                                ng-model="editingCopy.color"
                                color-picker-disabled="disableColorField(editingCopy.tag_type_group_id)"
                                color-picker-format="hex"
                                color-picker-alpha="false"
                                color-picker-swatch="true"
                                color-picker-swatch-bootstrap="true"
                                color-picker-swatch-only="true"
                                color-picker-inline="false"
                                aria-label="tag type color"
                            ></color-picker>
                        </md-input-container>
                    </md-content>
                </md-tab-body>
            </md-tab>
            <md-tab
                md-on-select="initNew(false)"
                md-on-deselect="clearEditing()">
                <md-label>
                    + tag group
                </md-label>
                <md-tab-body>
                    <md-content class="md-padding">
                        <md-input-container 
                          style="width:80%">
                            <label>tag type group name</label>
                            <input
                                required
                                ng-model="editingCopy.name"
                                aria-label="name"/>
                        </md-input-container>
                        
                        <md-input-container>
                            <color-picker
                                ng-model="editingCopy.color"
                                color-picker-format="hex"
                                color-picker-alpha="false"
                                color-picker-swatch="true"
                                color-picker-swatch-bootstrap="true"
                                color-picker-swatch-only="true"
                                color-picker-inline="false"
                                aria-label="tag type group color"
                            ></color-picker>
                        </md-input-container>
                        
                    </md-content>
                </md-tab-body>
            </md-tab>
        </md-tabs>
    </md-dialog-content>
    <md-dialog-actions 
        layout="row"
        ng-show="selectedIndex === 0">
     
        <span flex></span>
        <md-input-container 
            class="md-icon-float md-icon-right md-block">
            <input 
                ng-model="$ctrl.query"
                aria-label="search"
                style="margin-top:20px"/>
            <md-icon 
                class="material-icons"
                style="margin-top:25px">search</md-icon>
        </md-input-container>
    </md-dialog-actions>
    <md-dialog-actions 
        layout="row"
        ng-if="selectedIndex === 1 || selectedIndex === 2">
     
        <span flex></span>
        <md-button ng-click="cancel()">
            cancel
        </md-button>
        <md-button 
            ng-disabled="disableSave()"
            ng-click="save()"
            class="md-raised md-accent">
            save
        </md-button>
    </md-dialog-actions>
  </form>
</md-dialog>